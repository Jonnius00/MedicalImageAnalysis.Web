@page
@model MedicalImageAnalysis.Web.Pages.UploadModel
@{
    ViewData["Title"] = "Upload Medical Image";
}

<h2>Upload Medical Image</h2>

<form method="post" enctype="multipart/form-data">
  <input type="file" asp-for="UploadedFile" accept=".dcm,.png,.jpg,.jpeg,.nii" />
  <button type="submit">Upload</button>
</form>

@if (Model.DisplayImageUrl != null)
{
  <h3>Preview:</h3>
  <img src="@Model.DisplayImageUrl" style="max-width: 800px; border: 1px solid #ccc;" />
  <form method="post" asp-page-handler="ApplyOtsu" style="margin-top: 10px;">
      <input type="hidden" asp-for="DisplayImageUrl" />
      <button type="submit">Apply Otsu Thresholding</button>
  </form>
}

@if (Model.OtsuImageUrl != null)
{
    <h3>Otsu Result:</h3>
    <img src="@Model.OtsuImageUrl" style="max-width: 800px; border: 1px solid #ccc;" />
}

@if (Model.Modality != null)
{
  <div style="margin-top: 20px; padding: 10px; background: #f5f5f5; border-radius: 4px;">
      <h4>DICOM Metadata</h4>
      <p><strong>Patient:</strong> @Model.PatientName</p>
      <p><strong>Modality:</strong> @Model.Modality</p>
  </div>
}